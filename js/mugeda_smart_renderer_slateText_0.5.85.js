(function(){"use strict";var C=typeof self>"u"?window:self,g=globalThis.Mugine=globalThis.Mugine||{},u={};const v=u.namespace=function(e,t){var o=g;t==null&&(t={}),e=e.split(".");var n=o,r=e.length;return e.forEach(function(i,a){n[i]==null&&(r-1===a?n[i]=t:n[i]={}),n=n[i]}),t},E=u.exportName=function(e,t){var o=t.length,n,r,i;for(i=0;i<o;i+=2)n=t[i],r=t[i+1],e[n]=r};var O={}.hasOwnProperty;const b=u.extend=function(e,t){for(var o in t)O.call(t,o)&&(e[o]=t[o]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=e.__super__=t.prototype,e};var w=function(){throw new ReferenceError};u.definePropertyReadOnly=function(e,t){var o=t.length,n={},r,i,a;for(a=0;a<o;a+=2)r=t[a],i=t[a+1],n[r]={get:i,set:w,configurable:!0};Object.defineProperties(e,n)},u.definePropertyGetSet=function(e,t){var o=t.length,n={},r,i,a,c;for(c=0;c<o;c+=3)r=t[c],i=t[c+1],a=t[c+2],n[r]={get:i,set:a,configurable:!0};Object.defineProperties(e,n)},u.debounce=function(e,t,o){var n;return function(){var r=this,i=arguments,a=function(){n=null,o||e.apply(r,i)},c=o&&!n;clearTimeout(n),n=setTimeout(a,t),c&&e.apply(r,i)}},u.getWndSize=function(){var e=document.documentElement,t=e&&e.clientHeight===0;function o(){var i=document,a=i.createElement("div");a.style.height="2500px",i.body.insertBefore(a,i.body.firstChild);var c=i.documentElement.clientHeight>2400;return i.body.removeChild(a),c}var n=window.top===window;if(typeof document.clientWidth=="number")return{width:document.clientWidth,height:document.clientHeight};if(n&&(t||o())){var r=document.body;return{width:r.clientWidth,height:r.clientHeight}}else return{width:e.clientWidth,height:e.clientHeight}};var d={};u._jsonp=function(e,t,o){if(d[e])return d[e].push(o);d[e]=[o];var n=function(a,c){d[e].forEach(function(s){s(a,c)})},r=document.createElement("script");r.src=e,window[t]=function(a){n(null,a),i()},r.onload=function(){r.parentNode&&(n(!0),i())},r.onerror=function(){n(!0),i()};var i=function(){r.parentNode.removeChild(r),delete d[e]};document.body.appendChild(r)},C.MugineRequire=u.require=function(e){var t=g;return e.split("/").forEach(function(o){if(t=t[o],!t)return console.error("module not found: "+e)}),t},v("Utils.Module",u),E(u,["require",u.require,"namespace",u.namespace,"extend",u.extend,"definePropertyReadOnly",u.definePropertyReadOnly,"definePropertyGetSet",u.definePropertyGetSet]);var T=MugineRequire("Utils/Module"),R=MugineRequire("Text/TextField"),N=MugineRequire("Utils/Plugin"),l=function(){l.__super__.constructor.apply(this,arguments);var e=this;e._richContent=null,e._isRich=!1};b(l,R);var f=l.prototype;f.parseParamToDisplayObject=function(e,t){this._richContent=t.param.richContent,l.__super__.parseParamToDisplayObject.apply(this,arguments),this._isRich=!!t.param.richContent},f._updateDisplayObjectFromTransform=function(e){l.__super__._updateDisplayObjectFromTransform.apply(this,arguments)},l._createChildClass=function(e,t){var o=function(n){var r=this;this._resource=t,e.param.textContent==null&&(e.param.textContent=escape(y(e.param.richContent)||"")),o.__super__.constructor.apply(this,arguments),n&&n.addChild(r)};return T.extend(o,l),o},f._getHtmlText=function(){return this._isRich?this._richContent:l.__super__._getHtmlText.apply(this,arguments)};function y(e){if(!e||typeof e!="string")return"";const t=document.createElement("div");t.innerHTML=e;function o(r){return r.textContent.replace(/[\u200B-\u200D\uFEFF\s]/g,"")}function n(r){const i=[];function a(s){if(s.nodeType===Node.ELEMENT_NODE)if(s.tagName.toLowerCase()==="p"){let x=function(p){if(p.nodeType===Node.TEXT_NODE)h+=p.textContent;else if(p.nodeType===Node.ELEMENT_NODE)if(p.tagName.toLowerCase()==="br")h+=`
`;else for(let j of p.childNodes)x(j)},h="";for(let p of s.childNodes)x(p);o(s)?i.push(h):i.push("")}else for(let h of s.childNodes)a(h)}a(r);let c="";for(let s=0;s<i.length;s++){const m=i[s];s===0?c+=m:c+=`
`+m}return c}return n(t)}f._setText=function(e,t){var o=this,n=o._aniData.param.richContent,r=y(n);r=r.replace(new RegExp("\\p{Zs}","gu")," "),e!==r&&(delete o._aniData.param.richContent,o._isRich=!1),l.__super__._setText.apply(o,arguments)},T.exportName(f,["setText",f._setText,"getText",f._getText]),v("Text.SlateText",l),N._registerDisplayObjectClass(2010,l);var P=MugineRequire("Utils/Module"),M=MugineRequire("Render/RenderObjectTextField"),D=MugineRequire("Utils/Plugin"),_=function(){_.__super__.constructor.apply(this,arguments)};P.extend(_,M),_.prototype,D._registerRenderObjectClass(2010,_)})();
